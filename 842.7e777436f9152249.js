"use strict";(self.webpackChunkangular_SIMAt=self.webpackChunkangular_SIMAt||[]).push([[842],{7445:(g,S,t)=>{t.d(S,{_1:()=>N,H:()=>G});var e=t(5e3),d=t(8306),I=t(8746),M=t(3151),P=t(4968),v=t(3099),c=t(8675),r=t(4004),s=t(1884),l=t(9808);const u=new e.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:h}=(0,e.f3M)(l.K0);if(!h)throw new Error("Window is not available");return h}}),n=(new e.OlP("Shared Observable based on `window.requestAnimationFrame`",{factory:()=>{const{requestAnimationFrame:h,cancelAnimationFrame:R}=(0,e.f3M)(u);return new d.y(U=>{let L=NaN;const T=j=>{U.next(j),L=h(T)};return L=h(T),()=>{R(L)}}).pipe((0,v.B)())}}),new e.OlP("An abstraction over window.caches object",{factory:()=>(0,e.f3M)(u).caches}),new e.OlP("An abstraction over window.crypto object",{factory:()=>(0,e.f3M)(u).crypto}),new e.OlP("An abstraction over window.CSS object",{factory:()=>(0,e.f3M)(u).CSS||{escape:h=>h,supports:()=>!1}}),new e.OlP("An abstraction over window.history object",{factory:()=>(0,e.f3M)(u).history}),new e.OlP("An abstraction over window.localStorage object",{factory:()=>(0,e.f3M)(u).localStorage}),new e.OlP("An abstraction over window.location object",{factory:()=>(0,e.f3M)(u).location}),new e.OlP("An abstraction over window.navigator object",{factory:()=>(0,e.f3M)(u).navigator})),K=(new e.OlP("An abstraction over window.navigator.mediaDevices object",{factory:()=>(0,e.f3M)(n).mediaDevices}),new e.OlP("An abstraction over window.navigator.connection object",{factory:()=>(0,e.f3M)(n).connection||null}),new e.OlP("Shared Observable based on `document visibility changed`",{factory:()=>{const h=(0,e.f3M)(l.K0);return(0,P.R)(h,"visibilitychange").pipe((0,c.O)(0),(0,r.U)(()=>"hidden"!==h.visibilityState),(0,s.x)(),(0,M.d)({refCount:!1,bufferSize:1}))}}),new e.OlP("An abstraction over window.performance object",{factory:()=>(0,e.f3M)(u).performance}),new e.OlP("An abstraction over window.screen object",{factory:()=>(0,e.f3M)(u).screen}),new e.OlP("An abstraction over window.sessionStorage object",{factory:()=>(0,e.f3M)(u).sessionStorage}),new e.OlP("An abstraction over SpeechRecognition class",{factory:()=>{const h=(0,e.f3M)(u);return h.speechRecognition||h.webkitSpeechRecognition||null}}),new e.OlP("An abstraction over window.speechSynthesis object",{factory:()=>(0,e.f3M)(u).speechSynthesis}),new e.OlP("An abstraction over window.navigator.userAgent object",{factory:()=>(0,e.f3M)(n).userAgent}),new e.OlP("An abstraction over window.navigator.geolocation object",{factory:()=>(0,e.f3M)(n).geolocation})),G=new e.OlP("Token for an additional position options",{factory:()=>({})}),F=new e.OlP("Is Geolocation API supported?",{factory:()=>!!(0,e.f3M)(K)});let N=(()=>{class h extends d.y{constructor(A,U,L){let T=0;return super(j=>{U||j.error("Geolocation is not supported in your browser"),T=A.watchPosition(x=>j.next(x),x=>j.error(x),L)}),this.pipe((0,I.x)(()=>A.clearWatch(T)),(0,M.d)({bufferSize:1,refCount:!0}))}}return h.\u0275fac=function(A){return new(A||h)(e.LFG(K),e.LFG(F),e.LFG(G))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},9511:(g,S,t)=>{t.d(S,{f:()=>m});var e=t(5861),d=t(5963),I=t(4004),M=t(3151),P=t(1135),v=t(4244),c=t(2340),r=t(5e3),s=t(520),l=t(1271),u=t(629);let m=(()=>{class f{constructor(E,b,o){var _=this;this._http=E,this._snackbar=b,this._authService=o,this._time$=(0,d.H)(0,1e3).pipe((0,I.U)(n=>(this.TimeSubject.next(+this.TimeSubject.value+1e3),new Date)),(0,M.d)(1)),this._refreshTime$=(0,d.H)(0,6e4).pipe((0,I.U)(n=>{}),(0,M.d)(1)),this.TimeSubject=new P.X(+new Date),this.timer$.subscribe(()=>{}),this._refreshTime$.pipe((0,v.n)(()=>!this._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{yield _.getServerTime()}catch(n){_._snackbar.open(JSON.stringify(n),"error")}}))}get timer$(){return this._time$}get time$(){return this.TimeSubject.asObservable()}get currentTimestamp(){return this.TimeSubject.value}getServerTime(){return new Promise((E,b)=>{this._http.get(`${c.N.apiUrl}/get-time`,{responseType:"json"}).subscribe({next:o=>{this.TimeSubject.next(+new Date(o.Result)),E(o.Result)},error:o=>b(o.error),complete:()=>{}})})}}return f.\u0275fac=function(E){return new(E||f)(r.LFG(s.eN),r.LFG(l.ux),r.LFG(u.e))},f.\u0275prov=r.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},8203:(g,S,t)=>{t.d(S,{H:()=>e});var e=(()=>{return(d=e||(e={})).in_range="Anda berada di dalam jangkauan presensi",d.out_range="Anda berada di luar jangkauan presensi",d.searching="Sedang mengambil lokasi",d.fetching="Sedang mengambil radius presensi",d.location_off="Akses lokasi mati",e;var d})()},2223:(g,S,t)=>{t.d(S,{v:()=>p});var e=t(5861),d=t(5963),I=t(4004),M=t(3151),P=t(1135),v=t(4244),c=t(2340),r=t(5e3),s=t(520),l=t(629),u=t(9511),m=t(1271),f=t(9808);let p=(()=>{class E{constructor(o,_,n,i,a){this._http=o,this._authService=_,this._timeService=n,this._snackbar=i,this._datePipe=a,this.apiUrl=`${c.N.apiUrl}/attendance`,this._refreshTime$=(0,d.H)(0,6e4).pipe((0,I.U)(O=>{}),(0,M.d)(1)),this.AttendanceStatusSubject=new P.X(null),this._refreshTime$.pipe((0,v.n)(()=>!this._authService.isLoggedIn)).subscribe(()=>{this.getStatus()})}getStatus(){var o=this;return(0,e.Z)(function*(){var _,n;try{const i=yield o.status(o._authService.getUserData().id,o._datePipe.transform(o._timeService.currentTimestamp,"yyyy-MM-dd"));o.AttendanceStatusSubject.next(i)}catch(i){o._snackbar.open(null!==(n=null===(_=null==i?void 0:i.error)||void 0===_?void 0:_.Message)&&void 0!==n?n:JSON.stringify(i),"Error")}})()}get attendanceStatus$(){return this.AttendanceStatusSubject.asObservable()}get attendanceStatus(){return this.AttendanceStatusSubject.value}checkIn(o){const _=new FormData;return Object.keys(o).forEach(n=>{_.append(n,o[n])}),new Promise((n,i)=>{this._http.post(`${this.apiUrl}/checkIn`,_,{responseType:"json"}).subscribe({next:a=>n(a.Result),error:a=>i(a.error),complete:()=>{}})})}checkOut(o){const _=new FormData;return Object.keys(o).forEach(n=>{_.append(n,o[n])}),new Promise((n,i)=>{this._http.post(`${this.apiUrl}/checkOut`,_,{responseType:"json"}).subscribe({next:a=>n(a.Result),error:a=>i(a.error),complete:()=>{}})})}status(o,_){return new Promise((n,i)=>{this._http.post(`${this.apiUrl}/status`,{employee_id:o,date:_},{responseType:"json"}).subscribe({next:a=>n(a.Result),error:a=>i(a.error),complete:()=>{}})})}getAttendance(o,_,n){return new Promise((i,a)=>{this._http.get(`${this.apiUrl}/${o}?start_date=${encodeURIComponent(_)}&end_date=${encodeURIComponent(n)}`,{responseType:"json"}).subscribe({next:O=>i(O.Result),error:O=>a(O.error),complete:()=>{}})})}}return E.\u0275fac=function(o){return new(o||E)(r.LFG(s.eN),r.LFG(l.e),r.LFG(u.f),r.LFG(m.ux),r.LFG(f.uU))},E.\u0275prov=r.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},1481:(g,S,t)=>{t.d(S,{a:()=>b});var e=t(5861),d=t(5963),I=t(4004),M=t(3151),P=t(1135),v=t(5698),c=t(4244),r=t(2340),s=t(8203),l=t(5e3),u=t(7445),m=t(704),f=t(629),p=t(1271),E=t(520);let b=(()=>{class o{constructor(n,i,a,O,D){this._geolocation=n,this._alertService=i,this._authService=a,this._snackBar=O,this._http=D,this._time$=(0,d.H)(0,5e3).pipe((0,I.U)(C=>{}),(0,M.d)(1)),this.LocationPermissionStatusSubject=new P.X(!1),this.CheckInOutCoordinateSubject=new P.X(null),this.PermissionStateSubject=new P.X("granted"),this.IsInValidLocationSubject=new P.X(!1),this.PositionStatusSubject=new P.X(s.H.location_off),this.PositionSubject=new P.X(null),this.init()}init(){var n=this;return(0,e.Z)(function*(){n._time$.pipe((0,c.n)(()=>!n._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{const i=(yield navigator.permissions.query({name:"geolocation"})).state;"denied"===i&&(n._snackBar.open("Gagal mendapat akses lokasi, izinkan akses lokasi untuk situs ini melalui pengaturan","OK"),n.updatePosition(null)),n.PermissionStateSubject.next(i),n.LocationPermissionStatusSubject.next("granted"===i)}catch(i){n.LocationPermissionStatusSubject.next(!1)}finally{n.updatePositionStatus()}}));try{yield n.getPosition(),n.LocationPermissionStatusSubject.next(!0)}catch(i){n.LocationPermissionStatusSubject.next(!1)}})()}getDistance(n,i){const a=B=>B*Math.PI/180;var D=a(i.lat-n.lat),C=a(i.lng-n.lng),y=Math.sin(D/2)*Math.sin(D/2)+Math.cos(a(n.lat))*Math.cos(a(i.lat))*Math.sin(C/2)*Math.sin(C/2);return 2*Math.atan2(Math.sqrt(y),Math.sqrt(1-y))*6378137}get position$(){return this._geolocation}get position(){return this.PositionSubject.value}get isLocationOn$(){return this.LocationPermissionStatusSubject.asObservable()}get checkInOutCoordinate$(){return this.CheckInOutCoordinateSubject.asObservable()}get isInValidLocation$(){return this.IsInValidLocationSubject.asObservable()}get isInValidLocation(){return this.IsInValidLocationSubject.value}get positionStatus$(){return this.PositionStatusSubject.asObservable()}get positionStatus(){return this.PositionStatusSubject.value}get checkInOutCoordinate(){return this.CheckInOutCoordinateSubject.value}get getPermissionState(){return this.PermissionStateSubject.value}get isLocationOn(){return this.LocationPermissionStatusSubject.value}updateCheckInOutCoordinate(n){this.CheckInOutCoordinateSubject.next(n),this.updatePositionStatus()}updatePosition(n){this.PositionSubject.next(n),this.updatePositionStatus()}updateDistance(n,i){const a=this.getDistance(n,i);this.IsInValidLocationSubject.next(!!this.checkInOutCoordinate&&a<=this.checkInOutCoordinate.radius),this.updatePositionStatus()}updatePositionStatus(){this.isLocationOn||this.position?this.isLocationOn&&!this.position?this.PositionStatusSubject.next(s.H.searching):this.isLocationOn&&this.position&&!this.checkInOutCoordinate?this.PositionStatusSubject.next(s.H.fetching):this.isLocationOn&&this.position&&!this.isInValidLocation?this.PositionStatusSubject.next(s.H.out_range):this.isLocationOn&&this.position&&this.isInValidLocation&&this.PositionStatusSubject.next(s.H.in_range):this.PositionStatusSubject.next(s.H.location_off)}getPosition(){var n=this;return(0,e.Z)(function*(){return new Promise((i,a)=>{n._geolocation.pipe((0,v.q)(1)).subscribe({next:O=>i(O),error:O=>a(O),complete:()=>{}})})})()}getCheckInOutCoordinate(){return new Promise((n,i)=>{this._http.get(`${r.N.apiUrl}/get-validation-location`,{responseType:"json"}).subscribe({next:a=>{var O;n(a.Result),this.updateCheckInOutCoordinate(null!==(O=a.Result)&&void 0!==O?O:null)},error:a=>i(a.error),complete:()=>{}})})}}return o.\u0275fac=function(n){return new(n||o)(l.LFG(u._1),l.LFG(m.c),l.LFG(f.e),l.LFG(p.ux),l.LFG(E.eN))},o.\u0275prov=l.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},3151:(g,S,t)=>{t.d(S,{d:()=>P});var e=t(7579),d=t(6063);class I extends e.x{constructor(c=1/0,r=1/0,s=d.l){super(),this._bufferSize=c,this._windowTime=r,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=r===1/0,this._bufferSize=Math.max(1,c),this._windowTime=Math.max(1,r)}next(c){const{isStopped:r,_buffer:s,_infiniteTimeWindow:l,_timestampProvider:u,_windowTime:m}=this;r||(s.push(c),!l&&s.push(u.now()+m)),this._trimBuffer(),super.next(c)}_subscribe(c){this._throwIfClosed(),this._trimBuffer();const r=this._innerSubscribe(c),{_infiniteTimeWindow:s,_buffer:l}=this,u=l.slice();for(let m=0;m<u.length&&!c.closed;m+=s?1:2)c.next(u[m]);return this._checkFinalizedStatuses(c),r}_trimBuffer(){const{_bufferSize:c,_timestampProvider:r,_buffer:s,_infiniteTimeWindow:l}=this,u=(l?1:2)*c;if(c<1/0&&u<s.length&&s.splice(0,s.length-u),!l){const m=r.now();let f=0;for(let p=1;p<s.length&&s[p]<=m;p+=2)f=p;f&&s.splice(0,f+1)}}}var M=t(3099);function P(v,c,r){let s,l=!1;return v&&"object"==typeof v?({bufferSize:s=1/0,windowTime:c=1/0,refCount:l=!1,scheduler:r}=v):s=null!=v?v:1/0,(0,M.B)({connector:()=>new I(s,c,r),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:l})}},4244:(g,S,t)=>{t.d(S,{n:()=>I});var e=t(4482),d=t(5403);function I(M){return(0,e.e)((P,v)=>{let c=!1,r=0;P.subscribe((0,d.x)(v,s=>(c||(c=!M(s,r++)))&&v.next(s)))})}}}]);