"use strict";(self.webpackChunkangular_SIMAt=self.webpackChunkangular_SIMAt||[]).push([[842],{9143:(g,S,t)=>{t.d(S,{_1:()=>F,H:()=>K});var e=t(5e3),d=t(8306),p=t(8746),M=t(3151),f=t(4968),v=t(3099),l=t(8675),r=t(4004),s=t(1884),h=t(9808);const u=new e.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:_}=(0,e.f3M)(h.K0);if(!_)throw new Error("Window is not available");return _}}),o=(new e.OlP("Shared Observable based on `window.requestAnimationFrame`",{factory:()=>{const{requestAnimationFrame:_,cancelAnimationFrame:y}=(0,e.f3M)(u);return new d.y(R=>{let A=NaN;const L=T=>{R.next(T),A=_(L)};return A=_(L),()=>{y(A)}}).pipe((0,v.B)())}}),new e.OlP("An abstraction over window.caches object",{factory:()=>(0,e.f3M)(u).caches}),new e.OlP("An abstraction over window.crypto object",{factory:()=>(0,e.f3M)(u).crypto}),new e.OlP("An abstraction over window.CSS object",{factory:()=>(0,e.f3M)(u).CSS||{escape:_=>_,supports:()=>!1}}),new e.OlP("An abstraction over window.history object",{factory:()=>(0,e.f3M)(u).history}),new e.OlP("An abstraction over window.localStorage object",{factory:()=>(0,e.f3M)(u).localStorage}),new e.OlP("An abstraction over window.location object",{factory:()=>(0,e.f3M)(u).location}),new e.OlP("An abstraction over window.navigator object",{factory:()=>(0,e.f3M)(u).navigator})),B=(new e.OlP("An abstraction over window.navigator.mediaDevices object",{factory:()=>(0,e.f3M)(o).mediaDevices}),new e.OlP("An abstraction over window.navigator.connection object",{factory:()=>(0,e.f3M)(o).connection||null}),new e.OlP("Shared Observable based on `document visibility changed`",{factory:()=>{const _=(0,e.f3M)(h.K0);return(0,f.R)(_,"visibilitychange").pipe((0,l.O)(0),(0,r.U)(()=>"hidden"!==_.visibilityState),(0,s.x)(),(0,M.d)({refCount:!1,bufferSize:1}))}}),new e.OlP("An abstraction over window.performance object",{factory:()=>(0,e.f3M)(u).performance}),new e.OlP("An abstraction over window.screen object",{factory:()=>(0,e.f3M)(u).screen}),new e.OlP("An abstraction over window.sessionStorage object",{factory:()=>(0,e.f3M)(u).sessionStorage}),new e.OlP("An abstraction over SpeechRecognition class",{factory:()=>{const _=(0,e.f3M)(u);return _.speechRecognition||_.webkitSpeechRecognition||null}}),new e.OlP("An abstraction over window.speechSynthesis object",{factory:()=>(0,e.f3M)(u).speechSynthesis}),new e.OlP("An abstraction over window.navigator.userAgent object",{factory:()=>(0,e.f3M)(o).userAgent}),new e.OlP("An abstraction over window.navigator.geolocation object",{factory:()=>(0,e.f3M)(o).geolocation})),K=new e.OlP("Token for an additional position options",{factory:()=>({})}),G=new e.OlP("Is Geolocation API supported?",{factory:()=>!!(0,e.f3M)(B)});let F=(()=>{class _ extends d.y{constructor(D,R,A){let L=0;return super(T=>{R||T.error("Geolocation is not supported in your browser"),L=D.watchPosition(w=>T.next(w),w=>T.error(w),A)}),this.pipe((0,p.x)(()=>D.clearWatch(L)),(0,M.d)({bufferSize:1,refCount:!0}))}}return _.\u0275fac=function(D){return new(D||_)(e.LFG(B),e.LFG(G),e.LFG(K))},_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},9511:(g,S,t)=>{t.d(S,{f:()=>m});var e=t(5861),d=t(5963),p=t(4004),M=t(3151),f=t(1135),v=t(9300),l=t(2340),r=t(5e3),s=t(520),h=t(1271),u=t(629);let m=(()=>{class O{constructor(P,E,a){var n=this;this._http=P,this._snackbar=E,this._authService=a,this._time$=(0,d.H)(0,1e3).pipe((0,p.U)(o=>(this.TimeSubject.next(+this.TimeSubject.value+1e3),new Date)),(0,M.d)(1)),this._refreshTime$=(0,d.H)(0,6e4).pipe((0,p.U)(o=>{}),(0,M.d)(1)),this.TimeSubject=new f.X(+new Date),this.timer$.subscribe(()=>{}),this._refreshTime$.pipe((0,v.h)(()=>this._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{yield n.getServerTime()}catch(o){n._snackbar.open(JSON.stringify(o),"error")}}))}get timer$(){return this._time$}get time$(){return this.TimeSubject.asObservable()}get currentTimestamp(){return this.TimeSubject.value}getServerTime(){return new Promise((P,E)=>{this._http.get(`${l.N.apiUrl}/get-time`,{responseType:"json"}).subscribe({next:a=>{this.TimeSubject.next(+new Date(a.Result)),P(a.Result)},error:a=>E(a.error),complete:()=>{}})})}}return O.\u0275fac=function(P){return new(P||O)(r.LFG(s.eN),r.LFG(h.ux),r.LFG(u.e))},O.\u0275prov=r.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},8203:(g,S,t)=>{t.d(S,{H:()=>e});var e=(()=>{return(d=e||(e={})).in_range="Anda berada di dalam jangkauan presensi",d.out_range="Anda berada di luar jangkauan presensi",d.searching="Sedang mengambil lokasi",d.fetching="Sedang mengambil radius presensi",d.location_off="Akses lokasi mati",e;var d})()},2223:(g,S,t)=>{t.d(S,{v:()=>I});var e=t(5861),d=t(5963),p=t(4004),M=t(3151),f=t(1135),v=t(9300),l=t(2340),r=t(5e3),s=t(520),h=t(629),u=t(9511),m=t(1271),O=t(9808);let I=(()=>{class P{constructor(a,n,o,i,c){this._http=a,this._authService=n,this._timeService=o,this._snackbar=i,this._datePipe=c,this.apiUrl=`${l.N.apiUrl}/attendance`,this._refreshTime$=(0,d.H)(0,6e4).pipe((0,p.U)(b=>{}),(0,M.d)(1)),this.AttendanceStatusSubject=new f.X(null),this._refreshTime$.pipe((0,v.h)(()=>this._authService.isLoggedIn)).subscribe(()=>{this.getStatus()})}getStatus(){var a=this;return(0,e.Z)(function*(){var n,o;try{const i=yield a.status(a._authService.getUserData().id,a._datePipe.transform(a._timeService.currentTimestamp,"yyyy-MM-dd"));a.AttendanceStatusSubject.next(i)}catch(i){a._snackbar.open(null!==(o=null===(n=null==i?void 0:i.error)||void 0===n?void 0:n.Message)&&void 0!==o?o:JSON.stringify(i),"Error")}})()}get attendanceStatus$(){return this.AttendanceStatusSubject.asObservable()}get attendanceStatus(){return this.AttendanceStatusSubject.value}checkIn(a){const n=new FormData;return Object.keys(a).forEach(o=>{n.append(o,a[o])}),new Promise((o,i)=>{this._http.post(`${this.apiUrl}/checkIn`,n,{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>i(c.error),complete:()=>{}})})}checkOut(a){const n=new FormData;return Object.keys(a).forEach(o=>{n.append(o,a[o])}),new Promise((o,i)=>{this._http.post(`${this.apiUrl}/checkOut`,n,{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>i(c.error),complete:()=>{}})})}status(a,n){return new Promise((o,i)=>{this._http.post(`${this.apiUrl}/status`,{employee_id:a,date:n},{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>i(c.error),complete:()=>{}})})}getAttendance(a,n,o){return new Promise((i,c)=>{this._http.get(`${this.apiUrl}/${a}?start_date=${encodeURIComponent(n)}&end_date=${encodeURIComponent(o)}`,{responseType:"json"}).subscribe({next:b=>i(b.Result),error:b=>c(b.error),complete:()=>{}})})}}return P.\u0275fac=function(a){return new(a||P)(r.LFG(s.eN),r.LFG(h.e),r.LFG(u.f),r.LFG(m.ux),r.LFG(O.uU))},P.\u0275prov=r.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},1481:(g,S,t)=>{t.d(S,{a:()=>P});var e=t(5861),d=t(5963),p=t(4004),M=t(3151),f=t(1135),v=t(9300),l=t(5698),r=t(2340),s=t(8203),h=t(5e3),u=t(9143),m=t(629),O=t(1271),I=t(520);let P=(()=>{class E{constructor(n,o,i,c){this._geolocation=n,this._authService=o,this._snackBar=i,this._http=c,this._time$=(0,d.H)(0,5e3).pipe((0,p.U)(b=>{}),(0,M.d)(1)),this.LocationPermissionStatusSubject=new f.X(!1),this.CheckInOutCoordinateSubject=new f.X(null),this.PermissionStateSubject=new f.X("granted"),this.IsInValidLocationSubject=new f.X(!1),this.PositionStatusSubject=new f.X(s.H.location_off),this.PositionSubject=new f.X(null),this.init()}init(){var n=this;return(0,e.Z)(function*(){n._time$.pipe((0,v.h)(()=>n._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{const o=(yield navigator.permissions.query({name:"geolocation"})).state;"denied"===o&&(n._snackBar.open("Gagal mendapat akses lokasi, izinkan akses lokasi untuk situs ini melalui pengaturan","OK"),n.updatePosition(null)),n.PermissionStateSubject.next(o),n.LocationPermissionStatusSubject.next("granted"===o)}catch(o){n.LocationPermissionStatusSubject.next(!1)}finally{n.updatePositionStatus()}}));try{yield n.getPosition(),n.LocationPermissionStatusSubject.next(!0)}catch(o){n.LocationPermissionStatusSubject.next(!1)}})()}getDistance(n,o){const i=W=>W*Math.PI/180;var b=i(o.lat-n.lat),j=i(o.lng-n.lng),C=Math.sin(b/2)*Math.sin(b/2)+Math.cos(i(n.lat))*Math.cos(i(o.lat))*Math.sin(j/2)*Math.sin(j/2);return 2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C))*6378137}get position$(){return this._geolocation}get position(){return this.PositionSubject.value}get isLocationOn$(){return this.LocationPermissionStatusSubject.asObservable()}get checkInOutCoordinate$(){return this.CheckInOutCoordinateSubject.asObservable()}get isInValidLocation$(){return this.IsInValidLocationSubject.asObservable()}get isInValidLocation(){return this.IsInValidLocationSubject.value}get positionStatus$(){return this.PositionStatusSubject.asObservable()}get positionStatus(){return this.PositionStatusSubject.value}get checkInOutCoordinate(){return this.CheckInOutCoordinateSubject.value}get getPermissionState(){return this.PermissionStateSubject.value}get isLocationOn(){return this.LocationPermissionStatusSubject.value}updateCheckInOutCoordinate(n){this.CheckInOutCoordinateSubject.next(n),this.updatePositionStatus()}updatePosition(n){this.PositionSubject.next(n),this.updatePositionStatus()}updateDistance(n,o){const i=this.getDistance(n,o);this.IsInValidLocationSubject.next(!!this.checkInOutCoordinate&&i<=this.checkInOutCoordinate.radius),this.updatePositionStatus()}updatePositionStatus(){this.isLocationOn||this.position?this.isLocationOn&&!this.position?this.PositionStatusSubject.next(s.H.searching):this.isLocationOn&&this.position&&!this.checkInOutCoordinate?this.PositionStatusSubject.next(s.H.fetching):this.isLocationOn&&this.position&&!this.isInValidLocation?this.PositionStatusSubject.next(s.H.out_range):this.isLocationOn&&this.position&&this.isInValidLocation&&this.PositionStatusSubject.next(s.H.in_range):this.PositionStatusSubject.next(s.H.location_off)}getPosition(){var n=this;return(0,e.Z)(function*(){return new Promise((o,i)=>{n._geolocation.pipe((0,l.q)(1)).subscribe({next:c=>o(c),error:c=>i(c),complete:()=>{}})})})()}getCheckInOutCoordinate(){return new Promise((n,o)=>{this._http.get(`${r.N.apiUrl}/get-validation-location`,{responseType:"json"}).subscribe({next:i=>{var c;n(i.Result),this.updateCheckInOutCoordinate(null!==(c=i.Result)&&void 0!==c?c:null)},error:i=>o(i.error),complete:()=>{}})})}}return E.\u0275fac=function(n){return new(n||E)(h.LFG(u._1),h.LFG(m.e),h.LFG(O.ux),h.LFG(I.eN))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},3151:(g,S,t)=>{t.d(S,{d:()=>f});var e=t(7579),d=t(6063);class p extends e.x{constructor(l=1/0,r=1/0,s=d.l){super(),this._bufferSize=l,this._windowTime=r,this._timestampProvider=s,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=r===1/0,this._bufferSize=Math.max(1,l),this._windowTime=Math.max(1,r)}next(l){const{isStopped:r,_buffer:s,_infiniteTimeWindow:h,_timestampProvider:u,_windowTime:m}=this;r||(s.push(l),!h&&s.push(u.now()+m)),this._trimBuffer(),super.next(l)}_subscribe(l){this._throwIfClosed(),this._trimBuffer();const r=this._innerSubscribe(l),{_infiniteTimeWindow:s,_buffer:h}=this,u=h.slice();for(let m=0;m<u.length&&!l.closed;m+=s?1:2)l.next(u[m]);return this._checkFinalizedStatuses(l),r}_trimBuffer(){const{_bufferSize:l,_timestampProvider:r,_buffer:s,_infiniteTimeWindow:h}=this,u=(h?1:2)*l;if(l<1/0&&u<s.length&&s.splice(0,s.length-u),!h){const m=r.now();let O=0;for(let I=1;I<s.length&&s[I]<=m;I+=2)O=I;O&&s.splice(0,O+1)}}}var M=t(3099);function f(v,l,r){let s,h=!1;return v&&"object"==typeof v?({bufferSize:s=1/0,windowTime:l=1/0,refCount:h=!1,scheduler:r}=v):s=null!=v?v:1/0,(0,M.B)({connector:()=>new p(s,l,r),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:h})}}}]);