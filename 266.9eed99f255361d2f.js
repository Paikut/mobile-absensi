"use strict";(self.webpackChunkangular_SIMAt=self.webpackChunkangular_SIMAt||[]).push([[266],{4629:(g,S,t)=>{t.d(S,{_1:()=>F,H:()=>K});var e=t(5978),d=t(5879),b=t(5477),M=t(9448),P=t(8117),v=t(8261),_=t(3373),r=t(4549),i=t(5132),l=t(5154);const u=new e.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:h}=(0,e.f3M)(l.K0);if(!h)throw new Error("Window is not available");return h}}),o=(new e.OlP("Shared Observable based on `window.requestAnimationFrame`",{factory:()=>{const{requestAnimationFrame:h,cancelAnimationFrame:y}=(0,e.f3M)(u);return new d.y(R=>{let D=NaN;const j=L=>{R.next(L),D=h(j)};return D=h(j),()=>{y(D)}}).pipe((0,v.B)())}}),new e.OlP("An abstraction over window.caches object",{factory:()=>(0,e.f3M)(u).caches}),new e.OlP("An abstraction over window.crypto object",{factory:()=>(0,e.f3M)(u).crypto}),new e.OlP("An abstraction over window.CSS object",{factory:()=>(0,e.f3M)(u).CSS||{escape:h=>h,supports:()=>!1}}),new e.OlP("An abstraction over window.history object",{factory:()=>(0,e.f3M)(u).history}),new e.OlP("An abstraction over window.localStorage object",{factory:()=>(0,e.f3M)(u).localStorage}),new e.OlP("An abstraction over window.location object",{factory:()=>(0,e.f3M)(u).location}),new e.OlP("An abstraction over window.navigator object",{factory:()=>(0,e.f3M)(u).navigator})),B=(new e.OlP("An abstraction over window.navigator.mediaDevices object",{factory:()=>(0,e.f3M)(o).mediaDevices}),new e.OlP("An abstraction over window.navigator.connection object",{factory:()=>(0,e.f3M)(o).connection||null}),new e.OlP("Shared Observable based on `document visibility changed`",{factory:()=>{const h=(0,e.f3M)(l.K0);return(0,P.R)(h,"visibilitychange").pipe((0,_.O)(0),(0,r.U)(()=>"hidden"!==h.visibilityState),(0,i.x)(),(0,M.d)({refCount:!1,bufferSize:1}))}}),new e.OlP("An abstraction over window.performance object",{factory:()=>(0,e.f3M)(u).performance}),new e.OlP("An abstraction over window.screen object",{factory:()=>(0,e.f3M)(u).screen}),new e.OlP("An abstraction over window.sessionStorage object",{factory:()=>(0,e.f3M)(u).sessionStorage}),new e.OlP("An abstraction over SpeechRecognition class",{factory:()=>{const h=(0,e.f3M)(u);return h.speechRecognition||h.webkitSpeechRecognition||null}}),new e.OlP("An abstraction over window.speechSynthesis object",{factory:()=>(0,e.f3M)(u).speechSynthesis}),new e.OlP("An abstraction over window.navigator.userAgent object",{factory:()=>(0,e.f3M)(o).userAgent}),new e.OlP("An abstraction over window.navigator.geolocation object",{factory:()=>(0,e.f3M)(o).geolocation})),K=new e.OlP("Token for an additional position options",{factory:()=>({})}),G=new e.OlP("Is Geolocation API supported?",{factory:()=>!!(0,e.f3M)(B)});let F=(()=>{class h extends d.y{constructor(A,R,D){let j=0;return super(L=>{R||L.error("Geolocation is not supported in your browser"),j=A.watchPosition(U=>L.next(U),U=>L.error(U),D)}),this.pipe((0,b.x)(()=>A.clearWatch(j)),(0,M.d)({bufferSize:1,refCount:!0}))}}return h.\u0275fac=function(A){return new(A||h)(e.LFG(B),e.LFG(G),e.LFG(K))},h.\u0275prov=e.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),h})()},6610:(g,S,t)=>{t.d(S,{f:()=>f});var e=t(3986),d=t(5233),b=t(4549),M=t(9448),P=t(8435),v=t(7520),_=t(8006),r=t(5978),i=t(3046),l=t(9351),u=t(8007);let f=(()=>{class O{constructor(m,E,a){var n=this;this._http=m,this._snackbar=E,this._authService=a,this._time$=(0,d.H)(0,1e3).pipe((0,b.U)(o=>(this.TimeSubject.next(+this.TimeSubject.value+1e3),new Date)),(0,M.d)(1)),this._refreshTime$=(0,d.H)(0,6e4).pipe((0,b.U)(o=>{}),(0,M.d)(1)),this.TimeSubject=new P.X(+new Date),this.timer$.subscribe(()=>{}),this._refreshTime$.pipe((0,v.h)(()=>this._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{yield n.getServerTime()}catch(o){n._snackbar.open(JSON.stringify(o),"error")}}))}get timer$(){return this._time$}get time$(){return this.TimeSubject.asObservable()}get currentTimestamp(){return this.TimeSubject.value}getServerTime(){return new Promise((m,E)=>{this._http.get(`${_.N.apiUrl}/get-time`,{responseType:"json"}).subscribe({next:a=>{this.TimeSubject.next(+new Date(a.Result)),m(a.Result)},error:a=>E(a.error),complete:()=>{}})})}}return O.\u0275fac=function(m){return new(m||O)(r.LFG(i.eN),r.LFG(l.ux),r.LFG(u.e))},O.\u0275prov=r.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},6602:(g,S,t)=>{t.d(S,{H:()=>e});var e=(()=>{return(d=e||(e={})).in_range="Anda berada di dalam jangkauan presensi",d.out_range="Anda berada di luar jangkauan presensi",d.searching="Sedang mengambil lokasi",d.fetching="Sedang mengambil radius presensi",d.location_off="Akses lokasi mati",e;var d})()},5828:(g,S,t)=>{t.d(S,{v:()=>p});var e=t(3986),d=t(5233),b=t(4549),M=t(9448),P=t(8435),v=t(7520),_=t(8006),r=t(5978),i=t(3046),l=t(8007),u=t(6610),f=t(9351),O=t(5154);let p=(()=>{class m{constructor(a,n,o,s,c){this._http=a,this._authService=n,this._timeService=o,this._snackbar=s,this._datePipe=c,this.apiUrl=`${_.N.apiUrl}/attendance`,this._refreshTime$=(0,d.H)(0,6e4).pipe((0,b.U)(I=>{}),(0,M.d)(1)),this.AttendanceStatusSubject=new P.X(null),this._refreshTime$.pipe((0,v.h)(()=>this._authService.isLoggedIn)).subscribe(()=>{this.getStatus()})}getStatus(){var a=this;return(0,e.Z)(function*(){var n,o;try{const s=yield a.status(a._authService.getUserData().id,a._datePipe.transform(a._timeService.currentTimestamp,"yyyy-MM-dd"));a.AttendanceStatusSubject.next(s)}catch(s){a._snackbar.open(null!==(o=null===(n=null==s?void 0:s.error)||void 0===n?void 0:n.Message)&&void 0!==o?o:JSON.stringify(s),"Error")}})()}get attendanceStatus$(){return this.AttendanceStatusSubject.asObservable()}get attendanceStatus(){return this.AttendanceStatusSubject.value}checkIn(a){const n=new FormData;return Object.keys(a).forEach(o=>{n.append(o,a[o])}),new Promise((o,s)=>{this._http.post(`${this.apiUrl}/checkIn`,n,{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>s(c.error),complete:()=>{}})})}checkOut(a){const n=new FormData;return Object.keys(a).forEach(o=>{n.append(o,a[o])}),new Promise((o,s)=>{this._http.post(`${this.apiUrl}/checkOut`,n,{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>s(c.error),complete:()=>{}})})}status(a,n){return new Promise((o,s)=>{this._http.post(`${this.apiUrl}/status`,{employee_id:a,date:n},{responseType:"json"}).subscribe({next:c=>o(c.Result),error:c=>s(c.error),complete:()=>{}})})}getAttendance(a,n,o){return new Promise((s,c)=>{this._http.get(`${this.apiUrl}/${a}?start_date=${encodeURIComponent(n)}&end_date=${encodeURIComponent(o)}`,{responseType:"json"}).subscribe({next:I=>s(I.Result),error:I=>c(I.error),complete:()=>{}})})}}return m.\u0275fac=function(a){return new(a||m)(r.LFG(i.eN),r.LFG(l.e),r.LFG(u.f),r.LFG(f.ux),r.LFG(O.uU))},m.\u0275prov=r.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},4702:(g,S,t)=>{t.d(S,{a:()=>m});var e=t(3986),d=t(5233),b=t(4549),M=t(9448),P=t(8435),v=t(7520),_=t(1145),r=t(8006),i=t(6602),l=t(5978),u=t(4629),f=t(8007),O=t(9351),p=t(3046);let m=(()=>{class E{constructor(n,o,s,c){this._geolocation=n,this._authService=o,this._snackBar=s,this._http=c,this._time$=(0,d.H)(0,5e3).pipe((0,b.U)(I=>{}),(0,M.d)(1)),this.LocationPermissionStatusSubject=new P.X(!1),this.CheckInOutCoordinateSubject=new P.X(null),this.PermissionStateSubject=new P.X("granted"),this.IsInValidLocationSubject=new P.X(!1),this.PositionStatusSubject=new P.X(i.H.location_off),this.PositionSubject=new P.X(null),this.init()}init(){var n=this;return(0,e.Z)(function*(){n._time$.pipe((0,v.h)(()=>n._authService.isLoggedIn)).subscribe((0,e.Z)(function*(){try{const o=(yield navigator.permissions.query({name:"geolocation"})).state;"denied"===o&&(n._snackBar.open("Gagal mendapat akses lokasi, izinkan akses lokasi untuk situs ini melalui pengaturan","OK"),n.updatePosition(null)),n.PermissionStateSubject.next(o),n.LocationPermissionStatusSubject.next("granted"===o)}catch(o){n.LocationPermissionStatusSubject.next(!1)}finally{n.updatePositionStatus()}}));try{yield n.getPosition(),n.LocationPermissionStatusSubject.next(!0)}catch(o){n.LocationPermissionStatusSubject.next(!1)}})()}getDistance(n,o){const s=W=>W*Math.PI/180;var I=s(o.lat-n.lat),T=s(o.lng-n.lng),C=Math.sin(I/2)*Math.sin(I/2)+Math.cos(s(n.lat))*Math.cos(s(o.lat))*Math.sin(T/2)*Math.sin(T/2);return 2*Math.atan2(Math.sqrt(C),Math.sqrt(1-C))*6378137}get position$(){return this._geolocation}get position(){return this.PositionSubject.value}get isLocationOn$(){return this.LocationPermissionStatusSubject.asObservable()}get checkInOutCoordinate$(){return this.CheckInOutCoordinateSubject.asObservable()}get isInValidLocation$(){return this.IsInValidLocationSubject.asObservable()}get isInValidLocation(){return this.IsInValidLocationSubject.value}get positionStatus$(){return this.PositionStatusSubject.asObservable()}get positionStatus(){return this.PositionStatusSubject.value}get checkInOutCoordinate(){return this.CheckInOutCoordinateSubject.value}get getPermissionState(){return this.PermissionStateSubject.value}get isLocationOn(){return this.LocationPermissionStatusSubject.value}updateCheckInOutCoordinate(n){this.CheckInOutCoordinateSubject.next(n),this.updatePositionStatus()}updatePosition(n){this.PositionSubject.next(n),this.updatePositionStatus()}updateDistance(n,o){const s=this.getDistance(n,o);this.IsInValidLocationSubject.next(!!this.checkInOutCoordinate&&s<=this.checkInOutCoordinate.radius),this.updatePositionStatus()}updatePositionStatus(){this.isLocationOn||this.position?this.isLocationOn&&!this.position?this.PositionStatusSubject.next(i.H.searching):this.isLocationOn&&this.position&&!this.checkInOutCoordinate?this.PositionStatusSubject.next(i.H.fetching):this.isLocationOn&&this.position&&!this.isInValidLocation?this.PositionStatusSubject.next(i.H.out_range):this.isLocationOn&&this.position&&this.isInValidLocation&&this.PositionStatusSubject.next(i.H.in_range):this.PositionStatusSubject.next(i.H.location_off)}getPosition(){var n=this;return(0,e.Z)(function*(){return new Promise((o,s)=>{n._geolocation.pipe((0,_.q)(1)).subscribe({next:c=>o(c),error:c=>s(c),complete:()=>{}})})})()}getCheckInOutCoordinate(){return new Promise((n,o)=>{this._http.get(`${r.N.apiUrl}/get-validation-location`,{responseType:"json"}).subscribe({next:s=>{var c;n(s.Result),this.updateCheckInOutCoordinate(null!==(c=s.Result)&&void 0!==c?c:null)},error:s=>o(s.error),complete:()=>{}})})}}return E.\u0275fac=function(n){return new(n||E)(l.LFG(u._1),l.LFG(f.e),l.LFG(O.ux),l.LFG(p.eN))},E.\u0275prov=l.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})()},9448:(g,S,t)=>{t.d(S,{d:()=>P});var e=t(7365),d=t(425);class b extends e.x{constructor(_=1/0,r=1/0,i=d.l){super(),this._bufferSize=_,this._windowTime=r,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=r===1/0,this._bufferSize=Math.max(1,_),this._windowTime=Math.max(1,r)}next(_){const{isStopped:r,_buffer:i,_infiniteTimeWindow:l,_timestampProvider:u,_windowTime:f}=this;r||(i.push(_),!l&&i.push(u.now()+f)),this._trimBuffer(),super.next(_)}_subscribe(_){this._throwIfClosed(),this._trimBuffer();const r=this._innerSubscribe(_),{_infiniteTimeWindow:i,_buffer:l}=this,u=l.slice();for(let f=0;f<u.length&&!_.closed;f+=i?1:2)_.next(u[f]);return this._checkFinalizedStatuses(_),r}_trimBuffer(){const{_bufferSize:_,_timestampProvider:r,_buffer:i,_infiniteTimeWindow:l}=this,u=(l?1:2)*_;if(_<1/0&&u<i.length&&i.splice(0,i.length-u),!l){const f=r.now();let O=0;for(let p=1;p<i.length&&i[p]<=f;p+=2)O=p;O&&i.splice(0,O+1)}}}var M=t(8261);function P(v,_,r){let i,l=!1;return v&&"object"==typeof v?({bufferSize:i=1/0,windowTime:_=1/0,refCount:l=!1,scheduler:r}=v):i=null!=v?v:1/0,(0,M.B)({connector:()=>new b(i,_,r),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:l})}}}]);